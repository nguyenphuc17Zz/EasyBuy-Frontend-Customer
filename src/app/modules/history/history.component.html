<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
    <title>Ecommerce List | CORK - Multipurpose Bootstrap Dashboard Template </title>
    <link rel="icon" type="image/x-icon" href="../../../assets/src/assets/img/favicon.ico" />
    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700" rel="stylesheet">
    <link href="../../../assets/layouts/modern-light-menu/css/light/plugins.css" rel="stylesheet" type="text/css" />
    <!-- END GLOBAL MANDATORY STYLES -->

    <!--  BEGIN CUSTOM STYLE FILE  -->
    <link rel="stylesheet" type="text/css" href="../../../assets/src/plugins/src/table/datatable/datatables.css">

    <link rel="stylesheet" type="text/css"
        href="../../../assets/src/plugins/css/light/table/datatable/dt-global_style.css">
    <!--  END CUSTOM STYLE FILE  -->
    <link rel="stylesheet" href="history.component.css">


</head>
<app-header></app-header>
<app-sidebar></app-sidebar>

<body class="" data-bs-spy="scroll" data-bs-bs-target="#navSection" data-bs-offset="140">

    <!-- BEGIN LOADER -->

    <!--  END LOADER -->

    <!--  BEGIN NAVBAR  -->

    <!--  END NAVBAR  -->


    <!--  BEGIN MAIN CONTAINER  -->
    <div class="main-container " id="container">



        <!--  BEGIN SIDEBAR  -->

        <!--  END SIDEBAR  -->

        <!--  BEGIN CONTENT AREA  -->
        <div id="content" class="main-content" *ngIf="orders.length > 0 ; else nothing">

            <div class="layout-px-spacing">

                <div class="middle-content container-xxl p-0">

                    <!-- BREADCRUMB -->
                    <div class="page-meta">
                        <nav class="breadcrumb-style-one" aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#">App</a></li>
                                <li class="breadcrumb-item"><a href="#">Ecommerce</a></li>
                                <li class="breadcrumb-item active" aria-current="page">List</li>
                            </ol>
                        </nav>
                    </div>
                    <!-- /BREADCRUMB -->

                    <div class="row layout-top-spacing">
                        <div class="container mt-4">
                            <h2>Order History</h2>
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Ngày đặt</th>
                                        <th>Tiền ship</th>
                                        <th>Giảm giá</th>
                                        <th>Tổng tiền</th>
                                        <th>Địa chỉ</th>
                                        <th>Trạng thái</th>
                                        <th>Thao tác</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let order of orders">
                                        <td>{{ order.id }}</td>
                                        <td>{{ order.orderDate | date }}</td>
                                        <td>{{ order.shippingFee | currency }}</td>
                                        <td>{{ order.orderDiscount| currency }}</td>
                                        <td>{{ order.orderTotal| currency }}</td>
                                        <td>{{ order.address }}</td>
                                        <td>
                                            <span [ngClass]="{
                                                'text-success': order.status === 0,
                                                'text-danger': order.status === 1,
                                                'text-warning': order.status === 2
                                            }">
                                                {{ getStatusText(order.status) }}
                                            </span>
                                        </td>
                                        <td>
                                            <button class="btn btn-primary btn-sm"
                                                (click)="order.id ? viewDetails(order.id) : null">Xem chi tiết</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Order Details Overlay -->
                        <div class="overlay1" *ngIf="showOverlay">
                            <div class="overlay-content">
                                <button class="close-btn" (click)="closeOverlay()">X</button>
                                
                                <table class="table mt-3">
                                    <thead>
                                        <tr>
                                            <th>Hình ảnh</th>
                                            <th>Tên sản phẩm</th>
                                            <th>Số lượng</th>
                                            <th>Giá tiền</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let orderline of selectedOrder">
                                            <td><img [src]="'../src/assets/img/'+orderline.product?.productImg" alt="Product Image" width="50"></td>
                                            <td>{{ orderline.product?.productName }} - {{ orderline.product?.model }} - {{ orderline.product?.gender }} </td>
                                            <td>{{ orderline.quantity }}</td>
                                            <td>{{ formatCurrencyVND(orderline.unitPrice) }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>

                </div>

            </div>



        </div>
        <ng-template #nothing>
            <h4 style="margin-top: 100px; margin-left: 300px;">Chưa có đơn hàng nào được đặt</h4>
        </ng-template>
        <!--  END CONTENT AREA  -->
    </div>
    <!-- END MAIN CONTAINER -->
    <app-footer></app-footer>

</body>

</html>